<div id="users" class="page-layout carded fullwidth inner-scroll">
  <!-- TOP BACKGROUND -->
  <div class="top-bg accent"></div>
  <!-- / TOP BACKGROUND -->

  <!-- CENTER -->
  <div class="center">
    <!-- HEADER -->
    <div
      class="header accent first"
      fxLayout="col"
      fxLayoutAlign="center center"
      fxLayout.gt-sm="row"
      fxLayoutAlign.gt-sm="space-between center"
    >
      <!-- APP TITLE -->
      <div class="logo mb-24" fxLayout="row" fxLayoutAlign="start center">
        <!-- <mat-icon class="logo-icon s-32 mr-16" [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">
                        shopping_basket
                    </mat-icon> -->
        <span
          class="logo-text h1"
          [@animate]="{ value: '*', params: { delay: '100ms', x: '-25px' } }"
        >
          Rys Users
        </span>
      </div>
      <!-- / APP TITLE -->
      <!-- ADD BUTTON -->
      <!-- <button mat-raised-button [routerLink]="'/apps/e-commerce/products/new'"
                    class="add-product-button fuse-white mt-24 mt-md-0">
                    <span>ADD NEW PRODUCT</span>
                </button> -->
      <!-- / ADD BUTTON -->
      <div
        fxLayout="row"
        fxLayoutAlign="start"
        fxLayout.gt-sm="row"
        flex-md="33"
      >
        <!-- <div fxLayout="row" fxLayoutAlign="start" fxLayout.gt-sm="row" fxLayoutAlign.gt-sm="start start"> -->
        <!--Widget 1-->
        <div class="widget col" fxFlex="100" fxFlex.gt-sm="33">
          <div
            class="fuse-card auto-width mb-32"
            style="width:98% !important;height:56% !important; margin-top:35px !important;"
            [ngClass.gt-sm]="'mb-0 mr-32'"
          >
            <div
              class="p-16 pb-0"
              fxLayout="row wrap"
              fxLayoutAlign="start end"
            >
              <div class="" *ngIf="showCountBox">
                <div class="h3 secondary-text">No. of Users</div>
                <div
                  class="font-size-16 line-height-1"
                  id="state"
                  style="margin-top:30px;"
                >
                  {{ infoboxesNew.Total_Registered_Users }}&nbsp;
                  <!-- <mat-form-field>
                                        <mat-select class="simplified" value="state">
                                            <mat-option value="state">State</mat-option>
                                            <mat-option value="yesterday">1</mat-option>
                                            <mat-option value="7days">2</mat-option>
                                            <mat-option value="28days">3</mat-option>
                                            <mat-option value="90days">4</mat-option>
                                        </mat-select>
                                    </mat-form-field> -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <!---  / Widget -->
        <!-- Widget 2 -->
        <div class="widget col" fxFlex="100" fxFlex.gt-sm="33">
          <div
            class="fuse-card auto-width mb-32"
            style="width:98% !important;height:56% !important; margin-top:35px !important;"
            [ngClass.gt-sm]="'mb-0 mr-32'"
          >
            <div
              class="p-16 pb-0"
              fxLayout="row wrap"
              fxLayoutAlign="start end"
            >
              <!-- <div class="pr-16"> -->
              <div>
                <div class="h3 secondary-text">Users by Bike Brand</div>
                <div
                  class="font-size-16 line-height-1 mt-8"
                  id="state"
                  style="margin-top:10px;"
                >
                  {{ boxescount }} &nbsp;
                  <mat-form-field style="width:80px;">
                    <mat-label style="color:#f79726">Brand</mat-label>
                    <mat-select
                      class="simplified"
                      [(ngModel)]="selectedcountBrand"
                      (selectionChange)="countbrandSelectionChange($event)"
                    >
                      <mat-option
                        *ngFor="let brand of bikeBrands"
                        [value]="brand.BrandID"
                      >
                        {{ brand.BrandName }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- / Widget 2 -->

        <!-- Widget 3 -->
        <div class="widget col" fxFlex="100" fxFlex.gt-sm="33">
          <div
            class="fuse-card auto-width mb-32"
            style="width:98% !important;height:56% !important; margin-top:35px !important;"
            [ngClass.gt-sm]="'mb-0 mr-32'"
          >
            <div
              class="p-16 pb-0"
              fxLayout="row wrap"
              fxLayoutAlign="start end"
            >
              <div *ngIf="showCountBox">
                <div class="h3 secondary-text">Total Registered Users</div>
                <div
                  class="font-size-16 line-height-1 mt-5"
                  style="margin-top:30px;"
                >
                  {{ infoboxesNew.Total_Registered_Users }}&nbsp;&nbsp;
                  <span id="icon">
                    <img src="assets/icons/target.svg" width="40" height="50" />
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- / Widget 3 -->

        <!-- Widget 4 -->
        <!-- <div class="widget col" fxLayout="column" fxFlex="100" fxFlex.gt-sm="34">
    
                        <div class="fuse-card auto-width">
    
                            <div class="p-16 pb-0" fxLayout="row wrap" fxLayoutAlign="start end"> -->
        <div class="widget col" fxFlex="100" fxFlex.gt-sm="33">
          <div
            class="fuse-card auto-width mb-32"
            style="width:98% !important;height:56% !important; margin-top:35px !important;"
            [ngClass.gt-sm]="'mb-0 mr-32'"
          >
            <div
              class="p-16 pb-0"
              fxLayout="row wrap"
              fxLayoutAlign="start end"
            >
              <div *ngIf="showCountBox">
                <div class="h3 secondary-text">Total Subscribed Users</div>
                <div
                  class="font-size-16 line-height-1 mt-5"
                  style="margin-top:30px;"
                >
                  {{ infoboxesNew.Total_Subscribed_Users }} &nbsp;&nbsp;
                  <span id="icon">
                    <!-- <mat-icon aria-hidden="false" aria-label="strength" class="peopleicon">
                                            people_outline
                                        </mat-icon> -->
                    <img src="assets/icons/target.svg" width="40" height="50" />
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="widget col" fxFlex="100" fxFlex.gt-sm="33">
          <div
            class="fuse-card auto-width mb-32"
            style="width:96% !important;height:56% !important; margin-top:35px"
            [ngClass.gt-sm]="'mb-0 mr-32'"
          >
            <div
              class="p-16 pb-0"
              fxLayout="row wrap"
              fxLayoutAlign="start end"
            >
              <div *ngIf="showCountBox">
                <div class="h3 secondary-text">Total Subscripion Revenue</div>
                <div
                  class="font-size-16 line-height-1 mt-5"
                  style="margin-top:20px;"
                >
                  <span>&#x20b9;</span>
                  {{ infoboxesNew.Total_Subscripion_Revenue }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- / Widget 4 -->
        <br />
      </div>
    </div>
    <div class="row col-md-12">
      <div class="center">
        <div
          class="header accent"
          id="last"
          fxLayout="column"
          fxLayoutAlign="center center"
          fxLayout.gt-sm="row"
          fxLayoutAlign.gt-sm="space-between center"
          style="background-color:black !important;"
        >
          <!-- SEARCH -->
          <div class="search-wrapper mx-32 mx-md-0">
            <div
              class="search"
              fxFlex
              fxLayout="row"
              fxLayoutAlign="start center"
              style="width:145px !important;"
            >
              <input
                [(ngModel)]="searchTerm"
                (input)="filterUsersByName($event)"
                placeholder="Search User"
              />
            </div>
          </div>
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search"
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-left: -18px;"
            >
              <mat-form-field style="width:100px;margin-right: 18px;">
                <mat-label>Brand</mat-label>
                <mat-select
                  class="simplified"
                  [(ngModel)]="selectedBrand"
                  (selectionChange)="brandSelectionChange($event)"
                >
                  <mat-option
                    *ngFor="let brand of bikeBrands"
                    [value]="brand.BrandID"
                  >
                    {{ brand.BrandName }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field
                fxLayout="column"
                style="margin-right: -20px;width:130px;"
              >
                <mat-label style="color:#fff;">Search city</mat-label>
                <input
                  matInput
                  [(ngModel)]="selectedCity"
                  type="text"
                  (keydown.enter)="$event.preventDefault()"
                  placeholder="Search city"
                  autocorrect="off"
                  autocapitalize="off"
                  spellcheck="off"
                  type="text"
                  #userCitySearch
                />
              </mat-form-field>
            </div>
          </div>
          <!-- <div class="custom-wrapper mx-32 mx-md-0">
                        <div class="custom-search" fxLayout="row" fxLayoutAlign="start center">
                            <mat-form-field>
                                <mat-select class="simplified" value="City">
                                    <mat-option value="City">City</mat-option>
                                    <mat-option value="yesterday">1</mat-option>
                                    <mat-option value="7days">2</mat-option>
                                    <mat-option value="28days">3</mat-option>
                                    <mat-option value="90days">4</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div> -->
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search"
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-right: -20px;"
            >
              <mat-form-field style="width:100px;">
                <mat-label>Type Of Users</mat-label>
                <!-- <mat-select class="simplified" value="Subscribed">
                                    <mat-option value="Subscribed">Type Of Users</mat-option>
                                    <mat-option value="yesterday">All Users</mat-option>
                                    <mat-option value="7days">Registered Users</mat-option>
                                    <mat-option value="28days">Subscribed Users</mat-option>
                                </mat-select> -->
                <mat-select
                  class="simplified"
                  [(ngModel)]="selectedUser"
                  (selectionChange)="userSelectionChange($event)"
                >
                  <mat-option
                    *ngFor="let user of AllUsers"
                    [value]="user.value"
                  >
                    {{ user.Name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search"
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-right: -20px;"
            >
              <mat-form-field style="width:100px;">
                <mat-label>Requests</mat-label>

                <mat-select
                  class="simplified"
                  [(ngModel)]="selectedRequest"
                  (selectionChange)="requestSelectionChange($event)"
                >
                  <mat-option
                    *ngFor="let request of AllRequests"
                    [value]="request.value"
                  >
                    {{ request.Name }}
                  </mat-option>
                </mat-select>

                <!-- <mat-select class="simplified"  [(value)]="selected" (selectionChange)="requestSelectionChange($event);getValue(selected)">
                                    <mat-option value="Requests">Select</mat-option>
                                    <mat-option value="approveRequests" >
                                        Approve
                                        Requests</mat-option>
                                    <mat-option value="pendingProfiles" >Pending
                                        Profiles</mat-option>

                                </mat-select> -->
              </mat-form-field>
            </div>
          </div>
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search"
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-right: -20px;"
            >
              <button
                mat-raised-button
                class="add-product-button fuse-leader mt-24 mt-md-0"
                (click)="addDialog()"
              >
                <span>Leader Message Type</span>
              </button>
            </div>
          </div>
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search"
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-right: -15px;"
            >
              <button
                mat-raised-button
                class="add-product-button fuse-black mt-24 mt-md-0"
                (click)="exportToExcel()"
              >
                <span>Export</span>
              </button>
            </div>
          </div>
          <div class="custom-wrapper mx-32 mx-md-0">
            <div
              class="custom-search btn "
              fxLayout="row"
              fxLayoutAlign="start center"
              style="margin-right: -8px;"
            >
              <button
                mat-raised-button
                style="padding:0 5px"
                (click)="get()"
                class="add-product-button fuse-white mt-24 mt-md-0"
              >
                <span>Send Message</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- / HEADER -->

    <!-- / SEARCH -->
    <!-- CONTENT CARD -->
    <div class="content-card">
      <div
        style="text-align: center;padding:100px"
        *ngIf="dataSource.data.length === 0"
      >
        No Records Found
      </div>
      <mat-table
        class="users-table"
        #table
        [dataSource]="dataSource"
        *ngIf="dataSource.data.length != 0"
        matSort
        [@animateStagger]="{ value: '50' }"
        fusePerfectScrollbar
      >
        <!-- ID Column -->
        <!-- Checkbox Column -->
        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox
              (change)="$event ? masterToggle() : null"
              [checked]="selection.hasValue() && isAllSelected()"
              [indeterminate]="selection.hasValue() && !isAllSelected()"
              [aria-label]="checkboxLabel()"
            >
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox
              (click)="$event.stopPropagation()"
              (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)"
              [aria-label]="checkboxLabel(row)"
            >
            </mat-checkbox>
          </td>
        </ng-container>
        <ng-container matColumnDef="id" style="display:none;">
          <mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            style="display:none;"
            >ID</mat-header-cell
          >
          <mat-cell *matCellDef="let product" style="display:none;">
            <p class="text-truncate">{{ product.UserID }}</p>
          </mat-cell>
        </ng-container>

        <!-- UserName Column -->
        <ng-container matColumnDef="name">
          <mat-header-cell fxFlex="15%" *matHeaderCellDef>Name</mat-header-cell>
          <mat-cell
            fxFlex="15%"
            *matCellDef="let product"
            style="cursor:pointer;"
            (click)="setSelectedUser(product)"
          >
            <!-- <img class="avatar mr-0 mr-sm-16" src="assets/images/avatars/Velazquez.jpg"> -->
            <img
              class="avatar mr-0 mr-sm-16"
              src="{{
                product.ProfilePic || 'assets/images/profile/default-avatar.png'
              }}"
              (error)="onImgError($event)"
            />
            <p class="text-truncate">
              <b>{{ product.FirstName }} {{ product.LastName }}</b>
            </p>
          </mat-cell>
        </ng-container>

        <!-- Bike Column -->
        <ng-container matColumnDef="followers">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >Followers</mat-header-cell
          >
          <mat-cell
            *matCellDef="let product"
            style="margin-left:15px;"
            (click)="onSelect(product)"
          >
            <p class="text-truncate">
              <b>{{ product.Followers }}</b>
            </p>
          </mat-cell>
        </ng-container>

        <!-- City Column -->
        <ng-container matColumnDef="city">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >City</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <p class="category text-truncate">
              <b>{{ product.City }}</b>
            </p>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="bikes">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >Bikes</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <p class="category text-truncate">
              <b>{{ product.BrandNames }}</b>
            </p>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="ratings">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            Ratings</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <p class="category text-truncate">
              {{ product.AvgRating }}
              <mat-icon
                aria-hidden="false"
                aria-label="strength"
                style="font-size:15px;color:#EF5827;"
              >
                star
              </mat-icon>
            </p>
          </mat-cell>
        </ng-container>
        <!-- Date Column -->
        <ng-container matColumnDef="rides">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >Rides</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <p class="category text-truncate">
              <b>{{ product.RidesCount }}</b>
            </p>
          </mat-cell>
        </ng-container>

        <!-- Price Column -->
        <ng-container matColumnDef="kms">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            Kms
          </mat-header-cell>
          <mat-cell *matCellDef="let product">
            <p class="price text-truncate">
              <!-- {{product.priceTaxIncl | currency:'USD':'symbol'}} -->
              <b>{{ product.DistanceTravel.toFixed(2) }} Kms</b>
            </p>
          </mat-cell>
        </ng-container>

        <!-- Codes Column -->
        <ng-container matColumnDef="subscription">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            Subscription</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <p class="category text-truncate">
              <b>{{ product.Tenure }} months </b>
            </p>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="leaderboard" *ngIf="showColumn">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            Leaderboard</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <div
              (click)="addLeaderBoardDialog(product)"
              style="border: solid 1px #fff;height:30px;width:45px"
            >
              <mat-slide-toggle
                style="pointer-events:none"
                [(ngModel)]="product.Leaderboard"
              >
              </mat-slide-toggle>
            </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="profile">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            Profile</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <button
              mat-raised-button
              *ngIf="product.UserStatus == 6 && product.BrandNames!='NA'"
              class="add-product-button fuse-accept mt-24 mt-md-0"
              style="margin-right: 5px;"
              (click)="OnAcceptUser(product)"
            >
              <span>Accept</span>
            </button>
            <button
              mat-raised-button
              *ngIf="product.UserStatus == 6 && product.BrandNames!='NA'"
              class="add-product-button fuse-reject mt-24 mt-md-0"
              (click)="rejectmodalDialog()"
            >
              <span style="color:#e95130;">Reject</span>
            </button>
            <!-- <button mat-raised-button *ngIf = "product.UserStatus == 6"  (click)="OnRejectUser(product)" class="add-product-button fuse-reject mt-24 mt-md-0">
                            <span style="color:#e95130;">Reject</span>
                        </button> -->
            <mat-icon
              *ngIf="product.UserStatus == 1"
              class="active-icon green-600 s-16"
              >check</mat-icon
            >
            <button
              mat-raised-button
              *ngIf="product.UserStatus ==5 || product.BrandNames=='NA' "
              class="add-product-button fuse-red mt-24 mt-md-0"
            >
              <span>Pending</span>
            </button>
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

        <mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="product"
          (click)="selection.toggle(row)"
        >
        </mat-row>
      </mat-table>
      <mat-paginator
        #paginator
        [length]="dataSource.data.length"
        [pageIndex]="0"
        [pageSize]="10"
        [pageSizeOptions]="[5, 10, 25, 100]"
      >
      </mat-paginator>
    </div>
    <!-- / CONTENT CARD -->
  </div>
  <!-- / CENTER -->
</div>
